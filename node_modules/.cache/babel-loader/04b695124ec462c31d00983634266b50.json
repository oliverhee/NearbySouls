{"ast":null,"code":"var _jsxFileName = \"/Users/guoqinghe/Desktop/LaiOffer/around-web/src/components/AroundMap.js\";\nimport React, { Component } from 'react';\nimport { withScriptjs, withGoogleMap, GoogleMap } from \"react-google-maps\";\nimport { POS_KEY } from \"../constants\";\n\nclass NormalAroundMap extends Component {\n  constructor(...args) {\n    super(...args);\n\n    this.getMapRef = mapInstance => {\n      this.map = mapInstance;\n      window.map = mapInstance;\n    };\n\n    this.reloadMarker = () => {\n      const center = this.getCenter();\n      const radius = this.getRadius();\n      this.props.loadNearbyPosts(center, radius);\n    };\n\n    this.getRadius = () => {\n      const center = this.map.getCenter();\n      const bound = this.map.getBounds();\n\n      if (center && bound) {\n        const ne = bounds.getNorthEast();\n        const right = new window.google.maps.LatLng(center.lat(), ne.lng()); // right is an object\n\n        return 0.001 * window.google.maps.geometry.spherical.computeDistanceBetween(center, right);\n      }\n    };\n  }\n\n  render() {\n    const {\n      lat,\n      lon\n    } = JSON.parse(localStorage.getItem(POS_KEY));\n    return /*#__PURE__*/React.createElement(GoogleMap, {\n      ref: this.getMapRef,\n      defaultZoom: 8,\n      defaultCenter: {\n        lat: lat,\n        lng: lon\n      },\n      onDragEnd: this.reloadMarker,\n      onZoomChanged: this.reloadMarker,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 10,\n        columnNumber: 12\n      }\n    });\n  }\n\n  getCenter() {\n    const center = this.map.getCenter();\n    return {\n      lat: center.lat(),\n      lon: center.lng()\n    };\n  }\n\n}\n\nconst AroundMap = withScriptjs(withGoogleMap(NormalAroundMap));\nexport default AroundMap;","map":{"version":3,"sources":["/Users/guoqinghe/Desktop/LaiOffer/around-web/src/components/AroundMap.js"],"names":["React","Component","withScriptjs","withGoogleMap","GoogleMap","POS_KEY","NormalAroundMap","getMapRef","mapInstance","map","window","reloadMarker","center","getCenter","radius","getRadius","props","loadNearbyPosts","bound","getBounds","ne","bounds","getNorthEast","right","google","maps","LatLng","lat","lng","geometry","spherical","computeDistanceBetween","render","lon","JSON","parse","localStorage","getItem","AroundMap"],"mappings":";AAAA,OAAOA,KAAP,IAAeC,SAAf,QAA+B,OAA/B;AACA,SAASC,YAAT,EAAuBC,aAAvB,EAAsCC,SAAtC,QAAuD,mBAAvD;AAEA,SAAQC,OAAR,QAAsB,cAAtB;;AAEA,MAAMC,eAAN,SAA8BL,SAA9B,CAAwC;AAAA;AAAA;;AAAA,SAapCM,SAboC,GAavBC,WAAD,IAAiB;AACzB,WAAKC,GAAL,GAAWD,WAAX;AACAE,MAAAA,MAAM,CAACD,GAAP,GAAaD,WAAb;AACH,KAhBmC;;AAAA,SAkBpCG,YAlBoC,GAkBrB,MAAM;AACjB,YAAMC,MAAM,GAAG,KAAKC,SAAL,EAAf;AACA,YAAMC,MAAM,GAAG,KAAKC,SAAL,EAAf;AACA,WAAKC,KAAL,CAAWC,eAAX,CAA2BL,MAA3B,EAAmCE,MAAnC;AACH,KAtBmC;;AAAA,SA6BpCC,SA7BoC,GA6BxB,MAAM;AACd,YAAMH,MAAM,GAAG,KAAKH,GAAL,CAASI,SAAT,EAAf;AACA,YAAMK,KAAK,GAAG,KAAKT,GAAL,CAASU,SAAT,EAAd;;AAEA,UAAIP,MAAM,IAAIM,KAAd,EAAqB;AACjB,cAAME,EAAE,GAAGC,MAAM,CAACC,YAAP,EAAX;AACA,cAAMC,KAAK,GAAG,IAAIb,MAAM,CAACc,MAAP,CAAcC,IAAd,CAAmBC,MAAvB,CAA8Bd,MAAM,CAACe,GAAP,EAA9B,EAA4CP,EAAE,CAACQ,GAAH,EAA5C,CAAd,CAFiB,CAEoD;;AACrE,eAAO,QAAQlB,MAAM,CAACc,MAAP,CAAcC,IAAd,CAAmBI,QAAnB,CAA4BC,SAA5B,CAAsCC,sBAAtC,CAA6DnB,MAA7D,EAAqEW,KAArE,CAAf;AACH;AACJ,KAtCmC;AAAA;;AACpCS,EAAAA,MAAM,GAAG;AACL,UAAM;AAACL,MAAAA,GAAD;AAAMM,MAAAA;AAAN,QAAaC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqBhC,OAArB,CAAX,CAAnB;AACA,wBACG,oBAAC,SAAD;AAAW,MAAA,GAAG,EAAI,KAAKE,SAAvB;AACW,MAAA,WAAW,EAAE,CADxB;AAEW,MAAA,aAAa,EAAE;AAAEoB,QAAAA,GAAG,EAAEA,GAAP;AAAYC,QAAAA,GAAG,EAAEK;AAAjB,OAF1B;AAGW,MAAA,SAAS,EAAE,KAAKtB,YAH3B;AAIW,MAAA,aAAa,EAAE,KAAKA,YAJ/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADH;AAQH;;AAaDE,EAAAA,SAAS,GAAG;AACR,UAAMD,MAAM,GAAG,KAAKH,GAAL,CAASI,SAAT,EAAf;AACA,WAAO;AAAEc,MAAAA,GAAG,EAAEf,MAAM,CAACe,GAAP,EAAP;AAAqBM,MAAAA,GAAG,EAAErB,MAAM,CAACgB,GAAP;AAA1B,KAAP;AACH;;AA3BmC;;AA2CxC,MAAMU,SAAS,GAAGpC,YAAY,CAACC,aAAa,CAACG,eAAD,CAAd,CAA9B;AAEA,eAAegC,SAAf","sourcesContent":["import React, {Component} from 'react';\nimport { withScriptjs, withGoogleMap, GoogleMap } from \"react-google-maps\"\n\nimport {POS_KEY} from \"../constants\";\n\nclass NormalAroundMap extends Component {\n    render() {\n        const {lat, lon} = JSON.parse(localStorage.getItem(POS_KEY));\n        return (\n           <GoogleMap ref = {this.getMapRef}\n                      defaultZoom={8}\n                      defaultCenter={{ lat: lat, lng: lon }}\n                      onDragEnd={this.reloadMarker}\n                      onZoomChanged={this.reloadMarker}\n           />\n        );\n    }\n\n    getMapRef = (mapInstance) => {\n        this.map = mapInstance;\n        window.map = mapInstance;\n    }\n\n    reloadMarker = () => {\n        const center = this.getCenter();\n        const radius = this.getRadius();\n        this.props.loadNearbyPosts(center, radius);\n    }\n\n    getCenter() {\n        const center = this.map.getCenter();\n        return { lat: center.lat(), lon: center.lng() };\n    }\n\n    getRadius = () => {\n        const center = this.map.getCenter();\n        const bound = this.map.getBounds();\n\n        if (center && bound) {\n            const ne = bounds.getNorthEast();\n            const right = new window.google.maps.LatLng(center.lat(), ne.lng()); // right is an object\n            return 0.001 * window.google.maps.geometry.spherical.computeDistanceBetween(center, right);\n        }\n    }\n\n\n}\n\nconst AroundMap = withScriptjs(withGoogleMap(NormalAroundMap));\n\nexport default AroundMap;"]},"metadata":{},"sourceType":"module"}